<?xml version="1.0" encoding="UTF-8"?>
<plugin:page xmlns="html5" xmlns:plugin="plugin"
	xmlns:c="core" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="html5 html5 
						plugin plugin 
						core core">
	<plugin:body>
		<!-- breadcrumb -->
    	<div style="padding: 5px; overflow-y: auto; margin: 0.5rem 5px 0; line-height: 1.2rem; font-size: 1.3rem; font-weight: bold;">
    		<a id="${site.id}" href="javascript:void(0)" class="pseudo-siteLink" style="text-decoration: none">
					<c:out value="${site.metadata.title}" />
			</a>
			<c:if test="${not empty parents}">
				<span class="fa fa-play" style="margin: 0px 0.5rem; color: #0275d8;"></span>
	    		<c:iterate items="${parents}" var="parent" index="index">
	    			<a id="${parent.id}" href="javascript:void(0)" class="pseudo-pgLink" style="text-decoration: none">
						<c:out value="${parent.metadata.title}" />
					</a>
					<c:if test="${index &lt; parents.size() - 1}" >
						<span class="fa fa-play" style="margin: 0px 0.5rem; color: #0275d8;"></span>
					</c:if>
	    		</c:iterate>
    		</c:if>
    	</div>
    	
    	<!-- children -->
       	<div style="padding: 10px;">
       		<c:if test="${not empty children}">
	           	<table class="piston-table">
					<tr>
						<th>
							<t>Select Parent</t>
						</th>
						<th>
							<t>Title</t>
						</th>
					</tr>
					<c:iterate items="${children}" var="page">
						<tr>
							<td style="text-align:center;">
								<input type="radio" value="${page.id}" name="parentId" />
							</td>
							<td>
								<a id="${page.id}" href="javascript:void(0)" class="pseudo-pgLink" style="text-decoration: none">
									<c:out value="${page.metadata.title}" />
								</a>
							</td>
						</tr>
					</c:iterate>
				</table>       
			</c:if>
			<c:if test="${empty children}">
				<div style="margin-bottom: 0;" class="alert alert-info" role="alert">
					<span class="fa fa-info-circle fa-lg" style="margin-right: 0.5rem"></span>
					<c:out value="No data found."/>
				</div>
			</c:if>
       	</div>
		<script type="text/javascript">
        	<![CDATA[
        		$(function() {
        			$('.pseudo-siteLink').click(function() {
				   		var siteId = $(this).attr('id');
			        	var form = createPluginForm($(this), 'ajaxGetSitePageChildren');
						form.append(createHidden('siteId', siteId));
						$.ajax({
				    		async : false,
				            url: '/piston/ajaxPlugin',
				            type: 'POST',
							data: form.serializeArray(),
				            success: function(data) {
								$('#resChildren').html(data);
				            }
				    	});
				   });
        			
				   $('.pseudo-pgLink').click(function() {
				   		var siteId = $('#site').find("option:selected").attr("value");
				   		var parentId = $(this).attr('id');
						$('#wait').show();
			        	var form = createPluginForm($(this), 'ajaxGetSitePageChildren');
						form.append(createHidden('siteId', siteId));
						form.append(createHidden('parentId', parentId));
						form.append(createHidden('scenario', 'createUpdatePage'));
						$.ajax({
				    		async : false,
				            url: '/piston/ajaxPlugin',
				            type: 'POST',
							data: form.serializeArray(),
				            success: function(data) {
				                $('#wait').hide();
								$('#resChildren').html(data);
				            }
				    	});
				   });
        		});
        	]]>
        </script>
	</plugin:body>
</plugin:page>